## Phoenix – Additions, Tweaks, and Fixes
10/13/2025
### Additions

- Implemented full PyQt6 migration across all GUI modules.

- Added dynamic Hive theme loader; resolves theme file location at runtime.

- Introduced process embedding for session windows using native WinID and QWindow container.

- Added multiprocessing pipe communications between cockpit and session processes for real-time updates.

- Introduced centralized toast notification handler; cockpit now displays queued ui_toast events.

- Added unified outbound and inbound message dispatchers for session communication security.

- Added PhoenixControlPanel with deployment selector, vault management, and connection manager integration.

- Added PhoenixStaticPanel for deployment summaries and live swarm feed.

- Added PhoenixAgentTree for hierarchical agent visualization with flip-trip detection and context menus.

- Added StreamViewer for command streaming with favorites persistence and auto-refresh toggle.

- Added colored LogPanel for high-volume log streaming with background flush batching.

- Added RestartAgentDialog, DeleteAgentDialog, and ReplaceAgentDialog for interactive agent management.

- Added ReplaceAgentPanel to handle source replacement pipeline with packet dispatch and feedback routing.

### Tweaks

- Replaced all PyQt5 enums and constants with PyQt6 equivalents (Qt.ContextMenuPolicy.CustomContextMenu, Qt.ItemDataRole.UserRole, QDialog.DialogCode.Accepted, etc.).

- Reworked layout margins, spacing, and sizing across main panels and dialogs for consistency.

- Refactored SessionWindow startup to include QSS theming, window flag compatibility, and pipe polling timers.

- Moved all legacy blocking socket reads to timer-driven polling to prevent UI lockups.

- Centralized emit_gui_exception_log handling to capture and print all uncaught GUI exceptions.

- Replaced QMessageBox.StandardButton constants with PyQt6-compatible enum syntax.

- Deferred animation startup (QPropertyAnimation) until window visibility to avoid compositor crashes.

- Simplified vault synchronization logic; deployments now auto-broadcast on update.

- Unified all icon usage through QIcon path references in PhoenixControlPanel.

- Adjusted context menu role references to new PyQt6 enum structures.

- Normalized application window geometry and minimum sizes across modules.

- Enhanced SessionWindow panel caching mechanism for dynamic custom panels.

### Fixes

- Fixed application crashes caused by PyQt5 constants (QLineEdit.Password, QDialog.Accepted) under PyQt6.

- Fixed delayed startup crash from splash window teardown by replacing close() with hide() and deferred deleteLater().

- Fixed multiple GDI access violations (0xC0000409) caused by premature animation or transparency flag usage.

- Fixed broken Qt.UserRole in deployment tree by replacing with Qt.ItemDataRole.UserRole.

- Fixed Qt.CustomContextMenu crash by replacing with Qt.ContextMenuPolicy.CustomContextMenu.

- Fixed incorrect use of QMessageBox.Yes/No constants.

- Fixed vault broadcast duplication by filtering vault_update_request messages.

- Fixed missing QApplication guard in show_toast() calls to prevent NoneType access errors.

- Fixed pipe cleanup and zombie session retention with proper Process.join() and list removal.

- Fixed font rendering and transparency behavior in splash screen and dialogs.

- Fixed unresponsive cockpit startup when vault not loaded.

- Fixed incorrect data merging in vault update pipeline (vault_data["deployments"][dep_id]).

- Fixed theme load failure when matrix_gui/theme/hive_theme.qss not found by adding fallback path detection.

### Phoenix GUI (Core / Cockpit / Panels)

1. Qt 6 Migration & Stability

- Ported full codebase from PyQt5 → PyQt6, resolving:

- Qt.UserRole → Qt.ItemDataRole.UserRole updates

- QLineEdit.Password → QLineEdit.EchoMode.Password usage fixes

- QDialog.Accepted → QDialog.DialogCode.Accepted enum migration

- Replaced deprecated flags (e.g. Qt.CustomContextMenu → Qt.ContextMenuPolicy.CustomContextMenu)

- Unified window flag usage (FramelessWindowHint, Tool, WA_NativeWindow) to embed child sessions reliably

- Patched crashes ( Process exit 0xC0000409 ) by lazy-loading widgets after QApplication init and validating thread ownership.

2 · Phoenix Cockpit (Core App)

- Refactored startup sequence to run splash → vault unlock → dashboard cleanly.

- Embedded sessions now spawn via multiprocessing and report window_ready (winId) for containerized display.

- Added real-time pipe monitor (_poll_pipes) to handle child window messages, feed updates, and vault sync.

- Integrated animated drop-shadow for unlock button and non-blocking vault dialogs.

- Rebuilt session cleanup logic on pipe disconnects to avoid zombie processes.

3 · Vault Lifecycle / Control Panel

- Centralized vault open / save / reopen events via EventBus.

- Added deployment selector + connection manager dialogs with icons and QSS integration.

- New vault save handler persists deployments on any session update.

- Improved error handling when no vault or deployment data exists.

4 · Phoenix Static Panel (Dashboard)

- Displays live deployment summaries and swarm feed with color-coded entries (via FeedFormatter).

- Added right-click context menu for quick connect to deployments.

- Converted all Qt roles and menus to PyQt6-compliant constructs.

5 · Session Window Rebuild

- Complete refactor of SessionWindow layout into:

- Tree panel (Agent hierarchy)

- Inspector / Config panels (toggleable)

- Real-time log panel with chunked batch updates (QTimer flushing)

- Dynamic ControlBar system adds